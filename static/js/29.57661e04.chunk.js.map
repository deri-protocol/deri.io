{"version":3,"sources":["pages/Governance/DipTwo.js"],"names":["inject","observer","wallet","lang","useState","optionOne","setOptionOne","optionTwo","setOptionTwo","optionThree","setOptionThree","setCheckedOption","setUserVote","setUserPower","setCountVote","setSumVote","setTimestamp","radioChange","e","value","target","getUserVote","a","apiProxy","request","detail","account","res","option","timestamp","getUserPower","getVoting","num","alert","error","useEffect","window","setInterval","isConnected","className","href","rel","type","name","id","onChange","event","defaultChecked","for","label","width","fontSize"],"mappings":"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","file":"static/js/29.57661e04.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react'\nimport { inject, observer } from 'mobx-react'\nimport './dip.less'\nimport Button from '../../components/Button/Button'\nimport apiProxy from '../../model/ApiProxy'\nfunction DipTwo({ wallet = {}, lang }) {\n  const [optionOne, setOptionOne] = useState(false)\n  const [optionTwo, setOptionTwo] = useState(false)\n  const [optionThree, setOptionThree] = useState(false)\n  const [checkedOption, setCheckedOption] = useState('')\n  const [userVote, setUserVote] = useState('')\n  const [userPower, setUserPower] = useState('')\n  const [countVote, setCountVote] = useState([])\n  const [sumVote, setSumVote] = useState('')\n  const [timestamp, setTimestamp] = useState('')\n  const radioChange = (e) => {\n    let { value } = e.target\n    setCheckedOption(value)\n  }\n  const voteBtn = async () => {\n    if (!checkedOption) {\n      alert(lang['please-choose-your-vote-first'])\n      return\n    }\n    let res = await isOk()\n    if (res) {\n      getUserVote()\n      getUserPower()\n      getVoting()\n    }\n  }\n\n  const isOk = async () => {\n    let res = await apiProxy.request('vote', [wallet.detail.chainId, wallet.detail.account, checkedOption], { includeResponse: true })\n    if (res.success) {\n      let bool = true\n      while (bool) {\n        let data = await apiProxy.request('getUserVotingResult', [wallet.detail.account])\n        if (data.timestamp) {\n          data.timestamp > timestamp ? bool = false : bool = true\n        } else {\n          data.timestamp ? bool = false : bool = true\n        }\n      }\n      return true;\n    }\n  }\n\n\n  const getUserVote = async () => {\n    let res = await apiProxy.request('getUserVotingResult', [wallet.detail.account])\n    if (res) {\n      if (res.option === '1') {\n        setOptionOne(true)\n        setUserVote(\"I\")\n      } else if (res.option === '2') {\n        setOptionTwo(true)\n        setUserVote(\"II\")\n      } else if (res.option === '3') {\n        setOptionThree(true)\n        setUserVote(\"III\")\n      }\n      setTimestamp(res.timestamp)\n    }\n  }\n\n  const getUserPower = async () => {\n    let res = await apiProxy.request('getUserVotingPower', [wallet.detail.account])\n    if (res) {\n      setUserPower(res)\n    }\n  }\n\n  const getVoting = async () => {\n    let res = await apiProxy.request('getVotingResult', [])\n    if (res) {\n      let num = +res[0] + (+res[1]) + (+res[2])\n      setCountVote(res)\n      setSumVote(num)\n    } else {\n      alert(res.error)\n    }\n  }\n\n  useEffect(() => {\n    let interval = null;\n    interval = window.setInterval(() => {\n      getVoting()\n    }, 1000)\n  }, [])\n  useEffect(() => {\n    let interval = null;\n    if (wallet.isConnected()) {\n      interval = window.setInterval(() => {\n        getUserPower()\n        getUserVote()\n      }, 1000)\n    }\n  }, [wallet, wallet.detail.account])\n  return (\n    <div className='dip-box'>\n      <div className='dip-box-info'>\n        <div className='dip-info dip-two-info'>\n          <div className='dip-info-title'>\n            <div className='dip-title'>\n              {lang['dip-two']}\n            </div>\n            <div className='dip-des'>\n              <div>{lang['governance-describe']}</div>\n              <div>{lang['governance-describe-two']}</div>\n              <div>\n                {lang['governance-describe-three']} <a target='_blank' href='https://docs.deri.finance/mining-faq#what-do-i-harvest-for-liquidity-mining'  rel='noreferrer' >{lang['governance-describe-three-a']}</a>  {lang['governance-describe-three-one']}\n              </div>\n            </div>\n          </div>\n          <div className='dip-options'>\n            <div className='dip-options-checked'>\n              <div className='checkbox'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='1'\n                  id=\"I\"\n                  onChange={event => radioChange(event)}\n                  defaultChecked={optionOne}\n                />\n                <label for='I'>I.</label>\n              </div>\n              <div className='option-describe'>\n                <div>\n                  <div>\n                    {lang['governance-options-one-describe']}\n                  </div>\n                </div>\n\n              </div>\n              <div className='peng'>\n                <div className='peng-box'>\n                  <div className='peng-bg dip-two-one'></div>\n                  <div className='peng-num'>\n                    142,989 DERI\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className='dip-options-checked'>\n              <div className='checkbox'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='2'\n                  id=\"II\"\n                  onChange={event => radioChange(event)}\n                  defaultChecked={optionTwo}\n                />\n                <label for='II'>II.</label>\n              </div>\n              <div className='option-describe'>\n                <div>\n                  \n                  <div>\n                    {lang['governance-options-two-describe']}\n                  </div>\n                </div>\n\n              </div>\n              <div className='peng'>\n                <div className='peng-box'>\n                  <div className='peng-bg dip-two-two'></div>\n                  <div className='peng-num'>\n                    1,440,582 DERI\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className='dip-options-checked'>\n              <div className='checkbox'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='3'\n                  id=\"III\"\n                  onChange={event => radioChange(event)}\n                  defaultChecked={optionThree}\n                />\n                <label for='III'>III.</label>\n              </div>\n              <div className='option-describe'>\n                <div>\n                  <div>\n                    {lang['governance-options-three']}\n                  </div>\n                </div>\n\n              </div>\n              <div className='peng'>\n                <div className='peng-box'>\n                  <div className='peng-bg dip-two-three'></div>\n                  <div className='peng-num'>\n                    0 DERI\n                  </div>\n                </div>\n              </div>\n            </div>\n            <div className='vote-button'>\n              <Button label={lang['vote']} width='332' fontSize='18' />\n            </div>\n          </div>\n\n        </div>\n        <div className='voting-rules dip-two-rules'>\n          <div className='voting-rules-title'>\n            {lang['voting-rules']} :\n            </div>\n          <div className='voting-info'>\n            <div>1. {lang['vote-rules-one']}</div>\n            <div>{lang['vote-rules-one-describe-one']}</div>\n            <div>{lang['vote-rules-one-describe-two']}</div>\n            <div>{lang['vote-rules-one-describe-three']}</div>\n            <div>{lang['vote-rules-one-describe-four']}</div>\n          </div>\n          <div className='voting-info'>\n            <div>2.{lang['vote-rules-two']}</div>\n          </div>\n          <div className='voting-info'>\n            <div>3.{lang['vote-rules-three']}</div>\n          </div>\n          <div className='voting-info'>\n            <div>4.{lang['vote-rules-four']}</div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\nexport default inject('wallet')(observer(DipTwo))\n\n"],"sourceRoot":""}