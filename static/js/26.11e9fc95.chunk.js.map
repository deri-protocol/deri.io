{"version":3,"sources":["utils/DeriNumberFormat.js","pages/Governance/DipThree.js"],"names":["Wrapper","styled","NumberFormat","props","width","LoadLine","span","test","height","DeriNumberFormat","useState","className","renderablity","setRenderablity","firstTime","setFirstTime","isValidate","allowZero","value","undefined","isNaN","Math","abs","renderText","replace","useEffect","closeShowLoadingEffectAfterLoaded","wallet","defaultValue","others","decimalScale","bg","toFixed","countDecimal","toNonExponential","displayType","fixedDecimalScale","thousandSeparator","timeout","window","setTimeout","clearTimeout","suffix","inject","observer","lang","setValue","optionInfo","setOptionInfo","setSumPower","setWinner","setDisabled","isOptioned","setIsOptioned","setVotingPower","alert","useAlert","selectOption","radioI","document","getElementById","radioII","click","getUserVotingPower","ApiProxy","request","detail","account","res","getUserVotingResult","option","getVotingResult","sum","option_1","option_2","winnerPower","vote","console","log","chainId","includeResponse","success","error","isConnected","to","alt","src","backIcon","onClick","e","type","name","id","checked","for","style","disabled","label","fontSize","target","href"],"mappings":"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","file":"static/js/26.11e9fc95.chunk.js","sourcesContent":["import React,{useState,useEffect,useRef} from 'react'\nimport ReactDOM from 'react-dom'\nimport NumberFormat from 'react-number-format'\nimport { inject, observer } from 'mobx-react';\nimport styled from 'styled-components';\nimport { toNonExponential,countDecimal } from './utils';\nimport { bg } from '../lib/web3js';\nconst Wrapper = styled(NumberFormat)`\n  width : ${props => props.width}px;\n`\nconst LoadLine = styled.span`\n  width : ${props => /px$/.test(props.width) ? props.width : `${props.width}px`};\n  height : ${props => /px$/.test(props.height) ? props.height : `${props.height}px`};\n`\nfunction DeriNumberFormat(props){\n  const [renderablity, setRenderablity] = useState(<span className='loading-line'></span>);\n  const [firstTime, setFirstTime] = useState(true)\n  const isValidate = () => {\n    const {allowZero} = props \n    return (typeof props.value !== 'object' && props.value !== undefined && props.value !== ''  && !isNaN(props.value) && props.value !== 'NaN') \n          || ((Math.abs(props.value)) === 0 && allowZero === true )\n  }\n  const renderText = value => value && value.replace(/\\.$/,'')\n\n  useEffect(() => {\n    const {allowZero,wallet,closeShowLoadingEffectAfterLoaded,defaultValue = '--',...others} = props \n\n    if(isValidate()) {\n      //如果精度截取之后为0，则动态获取精度，取到不为0为止\n      if(others.decimalScale > 0 && others.value && /\\d+\\.0*[1-9]+/.test(others.value) && !allowZero && (+bg(others.value).toFixed((+others.decimalScale || 2))) === 0){\n        others.decimalScale = countDecimal(Math.abs(others.value)) + 2\n      } \n\n      if(others.decimalScale === -1 || ((+others.value) === 0 && allowZero)){\n        delete others.decimalScale\n      }\n\n      others.value = /e(\\+|=)?/.test(others.value) ? toNonExponential(others.value) : ''+others.value\n      if(others.value && /\\d+.9{6}/.test(others.value)){\n        others.value = (+others.value).toFixed(5)\n      }\n      setRenderablity(<Wrapper {...others}  renderText={renderText}\n      displayType = 'text'  fixedDecimalScale={true} thousandSeparator={true}/>)\n    } else if(firstTime){\n      const {width,height} = props\n      setRenderablity(<LoadLine className='loading-line' width={width} height={height}></LoadLine>)\n      if(closeShowLoadingEffectAfterLoaded){\n        setFirstTime(false)\n      }\n    } \n    const timeout = window.setTimeout(() => {\n      // && wallet && (!wallet.isConnected() || !wallet.supportChain)\n      if(!isValidate()){\n        setRenderablity(defaultValue)\n      }\n    },60000)\n    return () => {\n      clearTimeout(timeout)\n    };\n  }, [props.value,props.decimalScale,props.suffix]);\n\n  return renderablity;\n}\nexport default DeriNumberFormat\n// export default inject('wallet')(observer(DeriNumberFormat))","import './dip.less'\nimport { Link } from 'react-router-dom'\nimport { inject, observer } from 'mobx-react'\nimport React, { useState, useEffect } from 'react'\nimport Button from '../../components/Button/Button'\nimport { useAlert } from 'react-alert'\nimport DeriNumberFormat from '../../utils/DeriNumberFormat'\nimport ApiProxy from '../../model/ApiProxy'\nimport backIcon from '../../assets/img/back.svg'\nimport { set } from 'js-cookie'\nfunction DipThree({ wallet, lang }) {\n  const [value, setValue] = useState()\n  const [optionInfo, setOptionInfo] = useState()\n  const [sumPower, setSumPower] = useState(0)\n  const [winner, setWinner] = useState()\n  const [disabled, setDisabled] = useState(true)\n  const [isOptioned, setIsOptioned] = useState(true)\n  const [votingPower, setVotingPower] = useState()\n  const alert = useAlert();\n  const selectOption = (value) => {\n    if (!isOptioned) {\n      let radioI = document.getElementById(\"I\")\n      let radioII = document.getElementById(\"II\")\n      if (value === \"1\") {\n        radioI.click()\n      } else {\n        radioII.click()\n      }\n      setValue(value)\n    }\n\n  }\n  const getUserVotingPower = async () => {\n    let res = await ApiProxy.request(\"getUserVotingPower\", [wallet.detail.account])\n    setVotingPower(res)\n  }\n  const getUserVotingResult = async () => {\n    let res = await ApiProxy.request(\"getUserVotingResult\", [wallet.detail.account])\n    if (res.option !== \"0\") {\n      setValue(res.option)\n      setIsOptioned(true)\n    } else {\n      setIsOptioned(false)\n    }\n  }\n\n  const getVotingResult = async () => {\n    let res = await ApiProxy.request(\"getVotingResult\")\n    let sum = (+res.option_1) + (+res.option_2)\n    let winnerPower = (+res.option_1) > (+res.option_2) ? \"1\" : \"2\"\n    setWinner(winnerPower)\n    setSumPower(sum)\n    setOptionInfo(res)\n  }\n\n  const vote = async () => {\n    console.log([wallet.detail.chainId, wallet.detail.account, value])\n    let res = await ApiProxy.request(\"vote\", [wallet.detail.chainId, wallet.detail.account, value], { includeResponse: true })\n    if (res.success) {\n      getUserVotingPower()\n      getUserVotingResult()\n      getVotingResult()\n      alert.success(\"Success\")\n    } else {\n      alert.error(\"Failed\")\n    }\n\n  }\n  useEffect(() => {\n    if (wallet.isConnected()) {\n      getUserVotingPower()\n      getUserVotingResult()\n    }\n  }, [wallet, wallet.detail])\n  useEffect(() => {\n    getVotingResult()\n  }, [])\n  useEffect(() => {\n    if (wallet.isConnected() && value !== \"0\" && value && !isOptioned) {\n      setDisabled(false)\n    } else {\n      setDisabled(true)\n    }\n  }, [wallet.detail, value, optionInfo, isOptioned])\n  return (\n    <div className='dip-box'>\n      <div className='back-governance'>\n        <Link to='/governance'>\n          <div className='icon-back'>\n            <img alt='' src={backIcon} />\n            <span>{lang['back']}</span>\n          </div>\n        </Link>\n        <div className='poll-detail'>\n          {lang['poll-detail']}\n        </div>\n      </div>\n      <div className='dip-box-info'>\n        <div className='poll-dip-info'>\n          <div className='dip-list-title'>\n            <div className='title-text'>\n              {lang['dip']}-003\n            </div>\n            <div className='dip-progress'>\n              <div className='executed-bg'></div>\n              FINISHED\n            </div>\n          </div>\n          <div className='dip-list-des'>\n            Vote for changing the DERI burning mechanism\n          </div>\n          <div className='dip-time'>\n            End Time: 2022 Sat. 28th May 4:00 AM UTC\n          </div>\n        </div>\n        <div className='dip-option'>\n          <div className={value === \"1\" ? \"option-check option-checked\" : \"option-check\"} onClick={(e) => selectOption(\"1\")} >\n            <div className='dip-one-option-title option-title'>\n              <div className='option-check-text'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='1'\n                  id=\"I\"\n                  // onChange={event => selectOption(\"1\")}\n                  checked={value === \"1\"}\n                />\n                <label for=\"I\"></label>\n                <span className='option-title-text'>\n                  Remove from circulation Forever\n                </span>\n              </div>\n              <div className='option-num'>\n                1371480 {lang['deri-voting']} (48.53%)\n              </div>\n            </div>\n            <div className='option-peng-bg' style={{ width: \"48.53%\" }}></div>\n          </div>\n          <div className={value === \"2\" ? \"option-check option-checked\" : \"option-check\"} onClick={() => selectOption(\"2\")} >\n            <div className='dip-one-option-title option-title'>\n              <div className='option-check-text'>\n                <input\n                  type='radio'\n                  name='option'\n                  value='2'\n                  id=\"II\"\n                  // onChange={event => selectOption(\"2\")}\n                  checked={value === \"2\"}\n                />\n                <label for=\"II\"></label>\n                <span className='option-title-text'>\n                  Burn to mining vault (the status quo)\n                </span>\n              </div>\n              <div className='option-num'>\n                1454640 {lang['deri-voting']} (51.47%)\n              </div>\n            </div>\n            <div className='option-peng-bg ' style={{ width: '51.47%' }}></div>\n          </div>\n          <div className='vote-button'>\n            <div className='your-power'>\n              \n            </div>\n            <Button disabled={true} label={lang['vote']} onClick={vote} width='286' fontSize='18' />\n          </div>\n        </div>\n        <div className='dip-option-des-rules'>\n          <div className='description-close-open'>\n            {lang['description']}\n          </div>\n          <div className='description-text'>\n            <div className='ul-description'>\n              Based on the community poll on snapshot proposed by a community member, the Deri team has placed an executive proposal (DIP 3) into the governance voting system. DERI Holders should vote for this proposal if they want to change the current DERI burning mechanism.\n              <br></br>\n              The option one proposes to burn to deadlock address, thus removing DERI from circulation forever.\n              <br></br>\n              The option two is the status quo, which is that DERI bought from the secondary market is sent to the mining vault.\n              <a target=\"_blank\" href=\"https://docs.deri.io/library/tokenomics#burning-mechanism\">Read more.</a>\n            </div>\n          </div>\n\n          <div className='vote-rules'>\n            <div className='rules-title'>\n              {lang['voting-rules']}\n            </div>\n            <div className='rules-text'>\n              <div className='rules-margin'>\n                Your voting power is the summation of the following balances in your wallet as of the deadline:\n                <ul className='no-margin'>\n                  <li>DERI balance</li>\n                  <li>the corresponding DERI amount of your DERI-USDT SLP balance on SushiSwap</li>\n                  <li>the corresponding DERI amount of your DERI-BUSD CLP balance on PancakeSwap</li>\n                  <li>the corresponding DERI amount of your DLT balance in the DERI-based Inno Zone pools (BNB Chain)</li>\n                </ul>\n              </div>\n              <div className='rules-margin'>\n                You can choose any of the 3 chains (ETH/BNB Chain/Aribitrum) to sign your vote by the deadline\n              </div>\n              <div className='rules-margin'>\n                Voting Deadline: 2022 Sat. 28th May 4:00 AM UTC\n              </div>\n              <div className='rules-margin'>\n\n                A snapshot will be taken at the block, at the deadline, and used to calculate the result. Please note that, if you had voted before the deadline but then had transferred your DERI, SLP, PANCAKE-LP, or DLT before the deadline, it would be the balance at the deadline that counts.\n\n              </div>\n            </div>\n          </div>\n          <div className='supplementary-notes'>\n            <div className='notes-title'>\n              Reference Poll Link\n            </div>\n            <div className='notes-text'>\n              <a target=\"_blank\" href=\"https://snapshot.org/#/deri.eth/proposal/0xcba17b9e16742479631df206adc3f343b9b50979bd70452bb689a3266133ad55\">Snapshot</a>\n            </div>\n          </div>\n          <div className='supplementary-notes'>\n            <div className='notes-title'>\n              Discussion\n            </div>\n            <div className='notes-text'>\n              <a target=\"_blank\" href=\"https://discord.com/invite/kb8ZbYgp8M\">Discord</a>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  )\n}\nexport default inject('wallet')(observer(DipThree))\n\n\n"],"sourceRoot":""}