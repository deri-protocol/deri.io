{"version":3,"sources":["pages/Governance/DipTwo.js"],"names":["inject","observer","wallet","lang","useState","optionOne","setOptionOne","optionTwo","setOptionTwo","optionThree","setOptionThree","setCheckedOption","setUserVote","setUserPower","setCountVote","setSumVote","setTimestamp","radioChange","e","value","target","getUserVote","a","apiProxy","request","detail","account","res","option","timestamp","getUserPower","getVoting","num","alert","error","useEffect","window","setInterval","isConnected","className","href","rel","type","name","id","onChange","event","defaultChecked","for","label","width","fontSize"],"mappings":"qOA2OeA,sBAAO,SAAPA,CAAiBC,aAtOhC,YAAwC,IAAD,IAArBC,cAAqB,MAAZ,GAAY,EAARC,EAAQ,EAARA,KAAQ,EACHC,oBAAS,GADN,mBAC9BC,EAD8B,KACnBC,EADmB,OAEHF,oBAAS,GAFN,mBAE9BG,EAF8B,KAEnBC,EAFmB,OAGCJ,oBAAS,GAHV,mBAG9BK,EAH8B,KAGjBC,EAHiB,OAIKN,mBAAS,IAJd,mBAIfO,GAJe,aAKLP,mBAAS,IALJ,mBAKpBQ,GALoB,aAMHR,mBAAS,IANN,mBAMnBS,GANmB,aAOHT,mBAAS,IAPN,mBAOnBU,GAPmB,aAQPV,mBAAS,IARF,mBAQrBW,GARqB,aASHX,mBAAS,IATN,mBASnBY,GATmB,WAU/BC,EAAc,SAACC,GAAO,IACpBC,EAAUD,EAAEE,OAAZD,MACNR,EAAiBQ,IAgCbE,EAAW,uCAAG,4BAAAC,EAAA,sEACFC,IAASC,QAAQ,sBAAuB,CAACtB,EAAOuB,OAAOC,UADrD,QACdC,EADc,UAGG,MAAfA,EAAIC,QACNtB,GAAa,GACbM,EAAY,MACY,MAAfe,EAAIC,QACbpB,GAAa,GACbI,EAAY,OACY,MAAfe,EAAIC,SACblB,GAAe,GACfE,EAAY,QAEdI,EAAaW,EAAIE,YAbD,2CAAH,qDAiBXC,EAAY,uCAAG,4BAAAR,EAAA,sEACHC,IAASC,QAAQ,qBAAsB,CAACtB,EAAOuB,OAAOC,UADnD,QACfC,EADe,SAGjBd,EAAac,GAHI,2CAAH,qDAOZI,EAAS,uCAAG,8BAAAT,EAAA,sEACAC,IAASC,QAAQ,kBAAmB,IADpC,QACZG,EADY,SAGVK,GAAOL,EAAI,KAAOA,EAAI,KAAQA,EAAI,GACtCb,EAAaa,GACbZ,EAAWiB,IAEXC,MAAMN,EAAIO,OAPI,2CAAH,qDA0Bf,OAfAC,qBAAU,WAEGC,OAAOC,aAAY,WAC5BN,MACC,OACF,IACHI,qBAAU,WAEJjC,EAAOoC,eACEF,OAAOC,aAAY,WAC5BP,IACAT,MACC,OAEJ,CAACnB,EAAQA,EAAOuB,OAAOC,UAExB,qBAAKa,UAAU,UAAf,SACE,sBAAKA,UAAU,eAAf,UACE,sBAAKA,UAAU,wBAAf,UACE,sBAAKA,UAAU,iBAAf,UACE,qBAAKA,UAAU,YAAf,SACGpC,EAAK,aAER,sBAAKoC,UAAU,UAAf,UACE,8BAAMpC,EAAK,yBACX,8BAAMA,EAAK,6BACX,gCACGA,EAAK,6BADR,IACsC,mBAAGiB,OAAO,SAASoB,KAAK,yEAA0EC,IAAI,aAAtG,SAAqHtC,EAAK,iCADhK,KACsMA,EAAK,0CAI/M,sBAAKoC,UAAU,cAAf,UACE,sBAAKA,UAAU,sBAAf,UACE,sBAAKA,UAAU,WAAf,UACE,uBACEG,KAAK,QACLC,KAAK,SACLxB,MAAM,IACNyB,GAAG,IACHC,SAAU,SAAAC,GAAK,OAAI7B,EAAY6B,IAC/BC,eAAgB1C,IAElB,uBAAO2C,IAAI,IAAX,mBAEF,qBAAKT,UAAU,kBAAf,SACE,8BACE,8BACGpC,EAAK,yCAKZ,qBAAKoC,UAAU,OAAf,SACE,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,wBACf,qBAAKA,UAAU,WAAf,kCAMN,sBAAKA,UAAU,sBAAf,UACE,sBAAKA,UAAU,WAAf,UACE,uBACEG,KAAK,QACLC,KAAK,SACLxB,MAAM,IACNyB,GAAG,KACHC,SAAU,SAAAC,GAAK,OAAI7B,EAAY6B,IAC/BC,eAAgBxC,IAElB,uBAAOyC,IAAI,KAAX,oBAEF,qBAAKT,UAAU,kBAAf,SACE,8BAEE,8BACGpC,EAAK,yCAKZ,qBAAKoC,UAAU,OAAf,SACE,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,wBACf,qBAAKA,UAAU,WAAf,oCAMN,sBAAKA,UAAU,sBAAf,UACE,sBAAKA,UAAU,WAAf,UACE,uBACEG,KAAK,QACLC,KAAK,SACLxB,MAAM,IACNyB,GAAG,MACHC,SAAU,SAAAC,GAAK,OAAI7B,EAAY6B,IAC/BC,eAAgBtC,IAElB,uBAAOuC,IAAI,MAAX,qBAEF,qBAAKT,UAAU,kBAAf,SACE,8BACE,8BACGpC,EAAK,kCAKZ,qBAAKoC,UAAU,OAAf,SACE,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,0BACf,qBAAKA,UAAU,WAAf,4BAMN,qBAAKA,UAAU,cAAf,SACE,cAAC,IAAD,CAAQU,MAAO9C,EAAI,KAAU+C,MAAM,MAAMC,SAAS,eAKxD,sBAAKZ,UAAU,6BAAf,UACE,sBAAKA,UAAU,qBAAf,UACGpC,EAAK,gBADR,QAGA,sBAAKoC,UAAU,cAAf,UACE,sCAASpC,EAAK,qBACd,8BAAMA,EAAK,iCACX,8BAAMA,EAAK,iCACX,8BAAMA,EAAK,mCACX,8BAAMA,EAAK,qCAEb,qBAAKoC,UAAU,cAAf,SACE,qCAAQpC,EAAK,uBAEf,qBAAKoC,UAAU,cAAf,SACE,qCAAQpC,EAAK,yBAEf,qBAAKoC,UAAU,cAAf,SACE,qCAAQpC,EAAK","file":"static/js/29.0cbd2567.chunk.js","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { inject, observer } from 'mobx-react'\r\nimport './dip.less'\r\nimport Button from '../../components/Button/Button'\r\nimport apiProxy from '../../model/ApiProxy'\r\nfunction DipTwo({ wallet = {}, lang }) {\r\n  const [optionOne, setOptionOne] = useState(false)\r\n  const [optionTwo, setOptionTwo] = useState(false)\r\n  const [optionThree, setOptionThree] = useState(false)\r\n  const [checkedOption, setCheckedOption] = useState('')\r\n  const [userVote, setUserVote] = useState('')\r\n  const [userPower, setUserPower] = useState('')\r\n  const [countVote, setCountVote] = useState([])\r\n  const [sumVote, setSumVote] = useState('')\r\n  const [timestamp, setTimestamp] = useState('')\r\n  const radioChange = (e) => {\r\n    let { value } = e.target\r\n    setCheckedOption(value)\r\n  }\r\n  const voteBtn = async () => {\r\n    if (!checkedOption) {\r\n      alert(lang['please-choose-your-vote-first'])\r\n      return\r\n    }\r\n    let res = await isOk()\r\n    if (res) {\r\n      getUserVote()\r\n      getUserPower()\r\n      getVoting()\r\n    }\r\n  }\r\n\r\n  const isOk = async () => {\r\n    let res = await apiProxy.request('vote', [wallet.detail.chainId, wallet.detail.account, checkedOption], { includeResponse: true })\r\n    if (res.success) {\r\n      let bool = true\r\n      while (bool) {\r\n        let data = await apiProxy.request('getUserVotingResult', [wallet.detail.account])\r\n        if (data.timestamp) {\r\n          data.timestamp > timestamp ? bool = false : bool = true\r\n        } else {\r\n          data.timestamp ? bool = false : bool = true\r\n        }\r\n      }\r\n      return true;\r\n    }\r\n  }\r\n\r\n\r\n  const getUserVote = async () => {\r\n    let res = await apiProxy.request('getUserVotingResult', [wallet.detail.account])\r\n    if (res) {\r\n      if (res.option === '1') {\r\n        setOptionOne(true)\r\n        setUserVote(\"I\")\r\n      } else if (res.option === '2') {\r\n        setOptionTwo(true)\r\n        setUserVote(\"II\")\r\n      } else if (res.option === '3') {\r\n        setOptionThree(true)\r\n        setUserVote(\"III\")\r\n      }\r\n      setTimestamp(res.timestamp)\r\n    }\r\n  }\r\n\r\n  const getUserPower = async () => {\r\n    let res = await apiProxy.request('getUserVotingPower', [wallet.detail.account])\r\n    if (res) {\r\n      setUserPower(res)\r\n    }\r\n  }\r\n\r\n  const getVoting = async () => {\r\n    let res = await apiProxy.request('getVotingResult', [])\r\n    if (res) {\r\n      let num = +res[0] + (+res[1]) + (+res[2])\r\n      setCountVote(res)\r\n      setSumVote(num)\r\n    } else {\r\n      alert(res.error)\r\n    }\r\n  }\r\n\r\n  useEffect(() => {\r\n    let interval = null;\r\n    interval = window.setInterval(() => {\r\n      getVoting()\r\n    }, 1000)\r\n  }, [])\r\n  useEffect(() => {\r\n    let interval = null;\r\n    if (wallet.isConnected()) {\r\n      interval = window.setInterval(() => {\r\n        getUserPower()\r\n        getUserVote()\r\n      }, 1000)\r\n    }\r\n  }, [wallet, wallet.detail.account])\r\n  return (\r\n    <div className='dip-box'>\r\n      <div className='dip-box-info'>\r\n        <div className='dip-info dip-two-info'>\r\n          <div className='dip-info-title'>\r\n            <div className='dip-title'>\r\n              {lang['dip-two']}\r\n            </div>\r\n            <div className='dip-des'>\r\n              <div>{lang['governance-describe']}</div>\r\n              <div>{lang['governance-describe-two']}</div>\r\n              <div>\r\n                {lang['governance-describe-three']} <a target='_blank' href='https://docs.deri.io/mining-faq#what-do-i-harvest-for-liquidity-mining'  rel='noreferrer' >{lang['governance-describe-three-a']}</a>  {lang['governance-describe-three-one']}\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <div className='dip-options'>\r\n            <div className='dip-options-checked'>\r\n              <div className='checkbox'>\r\n                <input\r\n                  type='radio'\r\n                  name='option'\r\n                  value='1'\r\n                  id=\"I\"\r\n                  onChange={event => radioChange(event)}\r\n                  defaultChecked={optionOne}\r\n                />\r\n                <label for='I'>I.</label>\r\n              </div>\r\n              <div className='option-describe'>\r\n                <div>\r\n                  <div>\r\n                    {lang['governance-options-one-describe']}\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              <div className='peng'>\r\n                <div className='peng-box'>\r\n                  <div className='peng-bg dip-two-one'></div>\r\n                  <div className='peng-num'>\r\n                    142,989 DERI\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className='dip-options-checked'>\r\n              <div className='checkbox'>\r\n                <input\r\n                  type='radio'\r\n                  name='option'\r\n                  value='2'\r\n                  id=\"II\"\r\n                  onChange={event => radioChange(event)}\r\n                  defaultChecked={optionTwo}\r\n                />\r\n                <label for='II'>II.</label>\r\n              </div>\r\n              <div className='option-describe'>\r\n                <div>\r\n                  \r\n                  <div>\r\n                    {lang['governance-options-two-describe']}\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              <div className='peng'>\r\n                <div className='peng-box'>\r\n                  <div className='peng-bg dip-two-two'></div>\r\n                  <div className='peng-num'>\r\n                    1,440,582 DERI\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className='dip-options-checked'>\r\n              <div className='checkbox'>\r\n                <input\r\n                  type='radio'\r\n                  name='option'\r\n                  value='3'\r\n                  id=\"III\"\r\n                  onChange={event => radioChange(event)}\r\n                  defaultChecked={optionThree}\r\n                />\r\n                <label for='III'>III.</label>\r\n              </div>\r\n              <div className='option-describe'>\r\n                <div>\r\n                  <div>\r\n                    {lang['governance-options-three']}\r\n                  </div>\r\n                </div>\r\n\r\n              </div>\r\n              <div className='peng'>\r\n                <div className='peng-box'>\r\n                  <div className='peng-bg dip-two-three'></div>\r\n                  <div className='peng-num'>\r\n                    0 DERI\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n            <div className='vote-button'>\r\n              <Button label={lang['vote']} width='332' fontSize='18' />\r\n            </div>\r\n          </div>\r\n\r\n        </div>\r\n        <div className='voting-rules dip-two-rules'>\r\n          <div className='voting-rules-title'>\r\n            {lang['voting-rules']} :\r\n            </div>\r\n          <div className='voting-info'>\r\n            <div>1. {lang['vote-rules-one']}</div>\r\n            <div>{lang['vote-rules-one-describe-one']}</div>\r\n            <div>{lang['vote-rules-one-describe-two']}</div>\r\n            <div>{lang['vote-rules-one-describe-three']}</div>\r\n            <div>{lang['vote-rules-one-describe-four']}</div>\r\n          </div>\r\n          <div className='voting-info'>\r\n            <div>2.{lang['vote-rules-two']}</div>\r\n          </div>\r\n          <div className='voting-info'>\r\n            <div>3.{lang['vote-rules-three']}</div>\r\n          </div>\r\n          <div className='voting-info'>\r\n            <div>4.{lang['vote-rules-four']}</div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\nexport default inject('wallet')(observer(DipTwo))\r\n\r\n"],"sourceRoot":""}